<div class="page-wrapper">
  <div class="d-flex justify-content-center">
    <div class="d-flex flex-column">
      <div class="d-flex justify-content-center">
        <div class="h1">Szukasz paczki o numerze: {{parcelId}}</div>
      </div>

      <!-- display we still search for parcel, when we call backend -->
      <div *ngIf="wasParcelSearched; then parcelPresent else searchingForParcel"></div>

      <!-- when we got it display it -->
      <ng-template #parcelPresent>
        <div *ngIf="wasParcelFound; then parcelFound else parcelNotFound"></div>
      </ng-template>

      <ng-template #searchingForParcel>
        <div class="d-flex justify-content-center">
          <div class="h2">
            Szukamy paczki...
          </div>
        </div>
      </ng-template>

      <ng-template #parcelFound>
        <div class="d-flex justify-content-center">
          <div class="h2">
            Nazwa: {{parcel.name}}
          </div>
        </div>
        <div class="d-flex justify-content-center">
          <div class="h2">
            Status: {{translatedParcelStatus}}
          </div>
        </div>
        <div class="d-flex justify-content-center">
          <div class="h3">
            Rozmiar: {{parcel.size}}
          </div>
        </div>
        <div class="d-flex justify-content-center">
          <div class="h3">
            Waga: {{parcel.weightInKg + ' kg'}}
          </div>
        </div>
        <div class="d-flex justify-content-center">
          <div class="h3">
            Wymiary: {{parcel.length + 'x' + parcel.width + 'x' + parcel.height}} cm
          </div>
        </div>
        <div class="d-flex justify-content-center">
          <div class="h3">
            Adres nadawcy: {{parcel.senderCity + ' ' + parcel.senderStreet + ' ' + parcel.senderPostCode}}
          </div>
        </div>
        <div class="d-flex justify-content-center">
          <div class="h3">
            Adres odbiorcy: {{parcel.receiverCity + ' ' + parcel.receiverStreet + ' ' + parcel.receiverPostCode}}
          </div>
        </div>
        <div class="d-flex justify-content-center">
          <div class="h3">
            <ng-container
              *ngIf="parcel.status !== statusDelivered && parcel.status !== statusContact; else deliveredOrContact">

              <ng-container *ngIf="daysToDeliver > 0; else today">
                Otrzymasz paczkę za <b>{{daysToDeliver}}</b>

                <ng-container *ngIf="daysToDeliver > 1; else oneDay"> dni</ng-container>
                <ng-template #oneDay> dzień</ng-template>
              </ng-container>

              <ng-template #today>Otrzymasz paczkę <b>dzisiaj</b></ng-template>
            </ng-container>

            <ng-template #deliveredOrContact>
              <ng-container *ngIf="parcel.status === statusDelivered; else contact">
                <div class="alert-success">Udało się, przesyłka została dostarczona!</div>
              </ng-container>
              <ng-template #contact>
                <div class="alert-danger">Ups, mamy problem z przesyłką, skontaktuj się z obsługą klienta</div>
              </ng-template>
            </ng-template>
          </div>
        </div>

        <div class="d-flex justify-content-center">
          <div class="h3">
            <ng-container *ngIf="parcel.status !== statusDelivered && parcel.status !== statusContact; else delivered">
              Przewidywany termin dostawy: <b>{{expectedParcelDeliveryDate | date: 'dd/MM/yy':'UTC'}}</b>
            </ng-container>
            <ng-template #delivered>
              Przesyłka została dostarczona: <b>{{expectedParcelDeliveryDate | date: 'dd/MM/yy':'UTC'}}</b>
            </ng-template>
          </div>
        </div>

        <div class="d-flex justify-content-center">
          <div class="h3">
            Historia paczki:
          </div>
        </div>

        <ng-container *ngIf="wasParcelHistoryFound; else historyNotFound">
          <div class="row justify-content-center">
            <div id="pricing" class="container-fluid">
              <table class="table table-bordered table-striped text-center">
                <thead>
                <tr>
                  <th>DATA WPISU</th>
                  <th>STATUS</th>
                </tr>
                </thead>
                <tbody>
                <tr *ngFor="let parcelHistory of parcelHistories.parcelHistory">
                  <td>{{parcelHistory.timestamp | date: 'hh:mm dd/MM/yy':'UTC'}}</td>
                  <td>{{parcelHistory.status}}</td>
                </tr>
                </tbody>
              </table>
            </div>
          </div>

        </ng-container>

        <ng-template #historyNotFound>
          <div class="d-flex justify-content-center">
            <div class="h3">
              Nie można znaleźć historii
            </div>
          </div>
        </ng-template>

        <div class="form-header">
          <div class="h5">
            Zmień nazwę paczki na:
          </div>
          <label>
            <input #setInput class="au-input au-input-xl" type="text"
                   placeholder="Wprowadź nazwe paczki..."
                   (keyup.enter)="setNameOfParcel(setInput.value)"/>
          </label>
          <button class="au-btn-submit"
                  (click)="setNameOfParcel(setInput.value)">
            Zmień
          </button>
        </div>

        <div *ngIf="isNameLengthTooShort;">
          <div class="alert-danger">Nie zmieniono nazwy paczki, nazwa jest za krótka</div>
        </div>

        <div *ngIf="wasParcelNameChangeRequested">
          <div *ngIf="wasParcelNameChanged; else parcelNameNotChanged">
            <div class="alert-success">Poprawnie zmnieniono nazwę paczki</div>
          </div>
          <ng-template #parcelNameNotChanged>
            <div class="alert-danger">Nie udało sie zmienić nazwy paczki, spróbuj ponownie</div>
          </ng-template>
        </div>

        <!-- DO NOT REMOVE - adds some space after header! -->
        <div class="pt-3">

        </div>

        <!-- DO NOT REMOVE - adds some space after header! -->
        <div class="pt-3">

        </div>
        <!-- DO NOT REMOVE - adds some space after header! -->
        <div class="pt-3">

        </div>


      </ng-template>

      <ng-template #parcelNotFound>
        <div class="d-flex justify-content-center">
          <div class="h2">
            Nie znaleziono paczki
          </div>
        </div>
        <div class="d-flex justify-content-center">
          <div class="h2">
            Sprawdź jeszcze raz numer paczki
          </div>
        </div>
      </ng-template>


    </div>
  </div>
</div>

<!-- END PAGE CONTAINER-->
<footer>
  <app-footer></app-footer>
</footer>
